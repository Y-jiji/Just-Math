# 对象词法

## RoadMap
- [ ] 重写所有的 $\macro$ 为类型标注在下. 

## 方括号词法 [DEF]
::::文字::::
特别地让 $A[B]$ 表示 $([B]\;A)$, 造成一种使用面向对象语言的感觉. 
::::形式::::
$$
\BlockEndl{
    & \macro:\param A[\param B]:=([\param B]\;\param A)
}{\;\;}{
    & \param B\type{\Lit\mid \Op\mid\BigOp}\\
    & [\param B]::\rm T\to\Bool\\
    & \param A::\rm T\\
}
$$
::::注记::::
定义宏的一个常见套路是这样的: 
我们知道两个符号的含义, 而将它们直接拼接而成的标识符是未定义的, 这时根据括号等特殊符号就能解析内部内容, 将他们重新排成正确的顺序. 

## 特殊下角标词法 [DEF]
::::文字::::
用一个 $\List{\rm T}$ 作为下角标, 以此当作这个列表的某个属性. 
::::形式::::
$$
\BlockEndl{
    & \macro:\param B_{@ \param A}:=([\param B]\;\param A)
}{\;\;}{
    & \param B\type{\Lit}\\
    & [\param B]::\rm T\to\Bool\\
    & \param A::\rm T\\
}
$$

## 特殊上标词法 [DEF]
::::文字::::
用上标来表示二元运算符的应用. 
::::形式::::
$$
\begin{aligned}
& \BlockEndl{
    & \macro: \param C\overset{@ \param A}{\param B} \param D := 
        (\param A[\param B](\param C,\param D))\\
}{\;\;}{
    & \param A[\param B]::\Set{\rm Ta}\\
    & \param A::\List{\rm Tb\mid \Set{\rm Ta}}\\
    & \param C::\Set{\rm Ta}\\
    & \param D::\Set{\rm Ta}\\
}\\\\
& \BlockEndl{
    & \macro: \param C\overset{@ \param A}{\param B} \param D := 
        (\param A[\param B]\;\param C\;\param D)\\
}{\;\;}{
    & \param A[\param B]::{\rm X}\to{\rm Y}\to{\rm Z}\\
    & \param A::\List{\rm Tb}\\
    & \param C::{\rm X}\\
    & \param D::{\rm Y}\\
}\\\\
\end{aligned}
$$

## 取幂词法 [DEF]
::::文字::::
用特殊上标词法来代替取幂. 
::::形式::::
$$
\BlockEndl{
    & \macro:\param a^{\overset{@ \param X}{\param o}\param p} := 
    ({\tt exp}([\param o])\;\param X\;\param a\;\param p)
}{\;\;}{
    & \param X::{\rm X}\\
    & \param X::\List{\rm T}\\
    & \param a::{\rm Y}\\
    & \param p::{\rm Z}\\
    & \param{\tt exp}([\param o])::{\rm X}\to{\rm Y}\to{\rm Z}\to{\rm W}\\
    & \param o\type{\Op}
}
$$

## 特殊下标词法 [DEF]
::::文字::::
大算符的两个操作数分别是一个命题和一个用来计算的函数. 
::::形式::::
$$
\BlockEndl{
    & \macro:\mathop{\param B}_{@ \param A;\param C}\param D
    := ([\param B]\;\param A\;\param C\;\param D)
}{\;\;}{
    & \param A::\List{\rm T}\\
    & \param B::\BigOp\\
    & \param C::{\rm X}\to\Bool\\
    & \param D::{\rm X}\to {\rm Y}\\
}
$$
::::注记::::
1. 这里确实没有什么办法, 现在写个加法要写成下面这样. 虽然很阴间, 但只有这么做才能保证词法正确. $$
\sum_{@\R;a:(a=1)\or (a=2)\or (a=3)}(a:a^{\R[\cdot]2})
$$
2. 相比之下如果用习惯了也有更方便的地方, 比如说下面这个式子是合法的, 搁在以前就不可能这么写$$
\sum_{@\R;[1 .. 15]_{@ \R}\ni}(a:f(a))
$$
## 配对符 [DEF]
::::文字::::
由于配对符只有寥寥几种, 此处直接列出就是了. 
::::形式::::
$$
\BlockEndl{
    & \macro:\|\param p\|:=(\|\cdot\|\;a\;b)
}{\;\;}{
    & \param p::{\rm T}
}
$$
